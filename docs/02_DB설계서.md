# DB 설계서 (요약) — 전자책 판매 사이트

---

## 1. 주요 테이블 (총 12개)
- users, roles, user_roles (회원/권한)
- ebook, ebook_file (전자책 메타/파일)
- cart, cart_item (장바구니)
- orders, order_item, payment (주문/결제)
- download_token (구매자 전용 다운로드 토큰)
- review (구매자 리뷰)

---

## 2. 핵심 관계
- users 1:N orders  
- orders 1:N order_item  
- users 1:1 cart → cart 1:N cart_item  
- ebook 1:N ebook_file  
- order_item N:1 ebook  
- download_token N:1 users, N:1 ebook  
- review 1:1 order_item  
- users N:M roles (via user_roles)

---

## 3. 특징
- **스냅샷 저장**: order_item에 제목/가격 복사  
- **보안**: download_token으로 구매자만 접근  
- **제약**: order_item 1건당 review 1개

---

## 4. ERD다이어그램
![image](/docs/images/EbookERD.png) 
